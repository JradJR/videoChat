{"version":3,"sources":["SocketContext.js","components/Notifications.jsx","components/Options.jsx","components/VideoPlayer.jsx","App.js","index.js"],"names":["socketContext","createContext","socket","io","ContextProvider","children","useState","stream","setStream","me","setMe","call","setCall","callAccepted","setCallAccepted","callEnded","setCallEnded","name","setName","myVideo","useRef","userVideo","connectionRef","useEffect","navigator","mediaDevices","getUserMedia","video","audio","then","currentStream","current","srcObject","on","id","from","callerName","signal","isReceivedCall","Provider","value","callUser","peer","Peer","initiator","trickle","data","emit","userToCall","signalData","leaveCall","destroy","window","location","reload","answerCall","to","Notifications","useContext","style","display","justifyContent","Button","color","variant","onClick","useStyles","makeStyles","theme","root","flexDirection","gridContainer","width","breakpoints","down","container","margin","padding","marginTop","paper","border","Options","classes","idToCall","setIdToCall","console","log","Container","className","Paper","elevation","noValidate","autoComplete","Grid","item","xs","md","Typography","gutterBottom","TextField","label","onChange","e","target","text","fullWidth","startIcon","Assignment","fontSize","PhoneDisabled","Phone","VideoPlayer","playsInline","muted","ref","autoPlay","appBar","borderRadius","alignItems","image","marginLeft","wrapper","App","AppBar","position","align","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.2e51a0be.chunk.js","sourcesContent":["import React, {useState, useEffect, createContext, useRef} from 'react';\r\nimport {io} from 'socket.io-client';\r\nimport Peer from 'simple-peer';\r\n\r\nconst socketContext = createContext();\r\n\r\nconst socket = io('http://localhost:5000');\r\n\r\n\r\n\r\nconst ContextProvider = ({ children }) => {\r\n  \r\n  const [stream, setStream] = useState(null);\r\n  const [me, setMe] = useState('');\r\n  const [call, setCall] = useState({});\r\n  const [callAccepted, setCallAccepted] = useState(false);\r\n  const [callEnded, setCallEnded] = useState(false);\r\n  const [name, setName] = useState('');\r\n  \r\n  const myVideo = useRef();\r\n  const userVideo = useRef();\r\n  const connectionRef = useRef();\r\n\r\n  useEffect(() => {\r\n    navigator.mediaDevices.getUserMedia({video: true, audio: true})\r\n      .then(currentStream => {\r\n\r\n        setStream(currentStream);\r\n\r\n        myVideo.current.srcObject = currentStream;\r\n      })\r\n    \r\n    socket.on('me', (id => setMe(id)));\r\n\r\n    socket.on('calluser', ({ from, name: callerName, signal}) => {\r\n      setCall({ isReceivedCall: true, from, name: callerName, signal });\r\n    })\r\n  }, []);\r\n\r\n  const answerCall = () => {\r\n    setCallAccepted(true);\r\n\r\n    const peer = new Peer({ initiator: false, trickle: false, stream });\r\n\r\n    peer.on('signal', (data) => {\r\n      socket.emit('answerCall', { signal: data, to: call.from });\r\n    });\r\n\r\n    peer.on('stream', (currentStream) => {\r\n      userVideo.current.srcObject = currentStream;\r\n    });\r\n\r\n    peer.signal(call.signal);\r\n\r\n    connectionRef.current = peer;\r\n  };\r\n\r\n  const callUser = (id) => {\r\n    const peer = new Peer({ initiator: true, trickle: false, stream });\r\n\r\n    peer.on('signal', (data) => {\r\n      socket.emit('calluser', { userToCall: id, signalData: data, from: me, name });\r\n    });\r\n\r\n    peer.on('stream', (currentStream) => {\r\n      userVideo.current.srcObject = currentStream;\r\n    });\r\n\r\n    socket.on('callccepted', (signal) => {\r\n      setCallAccepted(true);\r\n\r\n      peer.signal(signal);\r\n    });\r\n\r\n    connectionRef.current = peer;\r\n  };\r\n\r\n  const leaveCall = () => {\r\n    setCallEnded(true);\r\n\r\n    connectionRef.current.destroy();\r\n\r\n    window.location.reload();\r\n  }\r\n\r\n\r\n  return (\r\n    <socketContext.Provider value={{\r\n      call, \r\n      callAccepted, \r\n      callEnded,\r\n      myVideo,\r\n      userVideo,\r\n      stream,\r\n      name,\r\n      setName,\r\n      me,\r\n      callUser,\r\n      leaveCall,\r\n      answerCall,\r\n    }}>\r\n\r\n      {children}\r\n\r\n    </socketContext.Provider>\r\n  )\r\n};\r\n\r\n\r\nexport { ContextProvider, socketContext };","import React, { useContext } from 'react'\r\nimport { Button } from '@material-ui/core'\r\nimport { socketContext } from '../SocketContext'\r\n\r\n\r\nconst Notifications = () => {\r\n  const { answerCall, call, callAccepted } = useContext(socketContext);\r\n\r\n\r\n  return (\r\n    <>\r\n      {\r\n        call.isReceivedCall && ! callAccepted && (\r\n          <div style={{display: 'flex', justifyContent: 'center'}}>\r\n            <h1>{`${call.name} is calling: `}</h1>\r\n            <Button color='primary' variant='contained' onClick={answerCall}>Answer</Button>\r\n          </div>\r\n        )\r\n      }\r\n    </>\r\n  )\r\n}\r\n\r\nexport default Notifications\r\n","import React, { useState, useContext } from 'react';\r\nimport { Button, Paper, Typography, TextField, Grid, Container } from '@material-ui/core';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport { CopyToClipboard } from 'react-copy-to-clipboard';\r\nimport { Phone, PhoneDisabled, Assignment } from '@material-ui/icons';\r\nimport { socketContext } from '../SocketContext';\r\n\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  root: {\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n  },\r\n  gridContainer: {\r\n    width: '100%',\r\n    [theme.breakpoints.down('xs')]: {\r\n      flexDirection: 'column',\r\n    },\r\n  },\r\n  container: {\r\n    width: '600px',\r\n    margin: '35px 0',\r\n    padding: 0,\r\n    [theme.breakpoints.down('xs')]: {\r\n      width: '80%',\r\n    },\r\n  },\r\n  margin: {\r\n    marginTop: 20,\r\n  },\r\n  padding: {\r\n    padding: 20,\r\n  },\r\n  paper: {\r\n    padding: '10px 20px',\r\n    border: '2px solid black',\r\n  },\r\n}));\r\n\r\n\r\nconst Options = ({ children }) => {\r\n  const classes = useStyles();\r\n  const { me, callAccepted, name, setName, callEnded , leaveCall, callUser } = useContext(socketContext);\r\n  const [idToCall, setIdToCall] = useState('');\r\n\r\n  console.log(idToCall);\r\n  return (\r\n    <Container className={classes.container}>\r\n      <Paper elevation={10} className={classes.paper}>\r\n        <from className={classes.root} noValidate autoComplete='off'>\r\n          <Grid container className={classes.gridContainer}>\r\n            <Grid item xs={12} md={6} className={classes.padding} >\r\n              <Typography gutterBottom variant='h6'>Account Info</Typography>\r\n              <TextField value={name} label='Name' onChange={e => setName(e.target.value)} />\r\n              <CopyToClipboard text={me} className={classes.margin}>\r\n                <Button variant='contained' color='primary' fullWidth startIcon={<Assignment fontSize='large'/>}>\r\n                  Copy Your ID\r\n                </Button>\r\n              </CopyToClipboard>\r\n            </Grid>\r\n\r\n            <Grid item xs={12} md={6} className={classes.padding} >\r\n              <Typography gutterBottom variant='h6'>Make a call</Typography>\r\n              <TextField value={idToCall} label='Id to call' onChange={e => setIdToCall(e.target.value)} />\r\n              {\r\n                callAccepted && !callEnded ? (\r\n                  <Button variant='contained' \r\n                          color='secondary'\r\n                          fullWidth\r\n                          onClick={leaveCall}\r\n                          className={classes.margin}\r\n                          startIcon={<PhoneDisabled fontSize='large'/>}>\r\n                          Hang Up\r\n                          </Button>\r\n                ):\r\n                (\r\n                  <Button\r\n                          variant='contained' \r\n                          color='primary'\r\n                          fullWidth\r\n                          onClick={() => callUser(idToCall)}\r\n                          className={classes.margin}\r\n                          startIcon={<Phone fontSize='large'/>} >\r\n                    Call \r\n                  </Button>\r\n                )\r\n              }\r\n            </Grid>\r\n\r\n            \r\n          </Grid>\r\n        </from>\r\n      {children}\r\n      </Paper>\r\n    </Container>\r\n  )\r\n}\r\n\r\nexport default Options\r\n","import React,{ useContext } from 'react'\r\nimport { Grid, Paper, Typography } from '@material-ui/core'\r\nimport { makeStyles } from '@material-ui/core/styles' \r\n\r\nimport { socketContext } from '../SocketContext';\r\n// import { CallEnded } from '@material-ui/icons';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  video: {\r\n    width: '550px',\r\n    [theme.breakpoints.down('xs')]: {\r\n      width: '300px',\r\n    },\r\n  },\r\n  gridContainer: {\r\n    justifyContent: 'center',\r\n    [theme.breakpoints.down('xs')]: {\r\n      flexDirection: 'column',\r\n    },\r\n  },\r\n  paper: {\r\n    padding: '10px',\r\n    border: '2px solid black',\r\n    margin: '10px',\r\n  },\r\n}));\r\n\r\n\r\nconst VideoPlayer = () => {\r\n  const {name, callAccepted, callEnded, myVideo, userVideo, stream, call} = useContext(socketContext);\r\n  const classes = useStyles();\r\n\r\n\r\n  return (\r\n    <Grid container className={classes.gridContainer}>\r\n      {\r\n        stream && (\r\n          <Paper className={classes.paper}>\r\n            <Grid item xs={12} md={6}>\r\n              <Typography variant='h5' gutterBottom>{name || 'Name'}</Typography>\r\n              <video playsInline muted ref={myVideo} autoPlay className={classes.video} />\r\n            </Grid>\r\n          </Paper>\r\n        )\r\n      }\r\n\r\n      {\r\n        callAccepted && !callEnded && (\r\n          <Paper className={classes.paper}>\r\n            <Grid item xs={12} md={6}>\r\n              <Typography variant='h5' gutterBottom>{call.name}</Typography>\r\n              <video playsInline ref={userVideo} autoPlay className={classes.video} />\r\n            </Grid>\r\n          </Paper>\r\n        )\r\n      }\r\n\r\n    </Grid>\r\n  )\r\n}\r\n\r\nexport default VideoPlayer\r\n","import React from 'react';\r\nimport { Typography, AppBar,  } from '@material-ui/core';\r\nimport Notifications from './components/Notifications';\r\nimport Options from './components/Options';\r\nimport VideoPlayer from './components/VideoPlayer';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  appBar: {\r\n    borderRadius: 15,\r\n    margin: '30px 100px',\r\n    display: 'flex',\r\n    flexDirection: 'row',\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    width: '600px',\r\n    border: '2px solid black',\r\n\r\n    [theme.breakpoints.down('xs')]: {\r\n      width: '90%',\r\n    },\r\n  },\r\n  image: {\r\n    marginLeft: '15px',\r\n  },\r\n  wrapper: {\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    alignItems: 'center',\r\n    width: '100%',\r\n  },\r\n}));\r\n\r\nconst App = () => {\r\n  const classes = useStyles();\r\n\r\n  return (\r\n    <div className={classes.wrapper}>\r\n      <AppBar className={classes.appBar} position=\"static\" color='inherit' >\r\n        <Typography variant='h2' align='center'>Vidoe Chat</Typography>\r\n      </AppBar>\r\n      <VideoPlayer/>\r\n      <Options>\r\n        <Notifications/>\r\n      </Options>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default App\r\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport './styles.css';\nimport { ContextProvider } from './SocketContext';\n\nReactDOM.render(\n    <ContextProvider>\n      <App/>\n    </ContextProvider>\n  , document.getElementById('root'));\n\n"],"sourceRoot":""}